<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>使用MediaStream API訪問相機和麥克風</title>
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:alt" content="使用MediaStream API訪問相機和麥克風" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/water.css@2/out/dark.min.css" media="screen" />
    <link rel="stylesheet" href="style.min.css" media="screen" />
  </head>
  <body>
    <div class="container" id="app">
      <div class="title">
        <h1>使用MediaStream API訪問相機和麥克風</h1>
      </div>
      <h2>範例</h2>
      <h3>1. 前鏡頭 - 錄製影片</h3>
      <p>
        <label for="videoUser" class="custom-button">開始前鏡頭錄影</label>
      </p>
      <p>結果：</p>
      <video id="videoUser" controls="controls"></video>
      <hr />
      <h3>2. 前鏡頭 - 拍照</h3>
      <p>
        <label for="photoUser" class="custom-button">拍前鏡頭照片</label>
      </p>
      <p>結果：</p>
      <img id="photoUserImage" class="hidden" />
      <hr />
      <h3>3. 後鏡頭 - 錄製影片</h3>
      <p>
        <label for="videoEnv" class="custom-button">開始後鏡頭錄影</label>
      </p>
      <p>結果：</p>
      <video id="videoEnv" controls="controls"></video>
      <hr />
      <h3>4. 後鏡頭 - 拍照</h3>
      <p>
        <label for="photoEnv" class="custom-button">拍後鏡頭照片</label>
      </p>
      <p>結果：</p>
      <img id="photoEnvImage" class="hidden" />
      <hr />
      <h3>5. 前鏡頭 - 錄製音訊</h3>
      <p>
        <label for="audioUser" class="custom-button">開始前鏡頭錄音</label>
      </p>
      <p>結果：</p>
      <audio id="audioUser" controls="controls"></audio>
      <hr />
    </div>
    <style>
      /* 隱藏媒體元素 */
      .hidden {
        display: none;
      }

      /* 自定義按鈕樣式 */
      .custom-button {
        background-color: transparent;
        color: white;
        padding: 10px 20px;
        cursor: pointer;
        border: 4px solid hsl(270, 92%, 81%);
        border-radius: 5px;
      }

      /* 按鈕懸停樣式 */
      .custom-button:hover {
        background-color: #cfa3fb;
      }
    </style>
    <script>
      // 函數用於訪問媒體設備並顯示流
      async function startMediaStream(deviceType, mediaType, resultElementId) {
        try {
          const stream = await navigator.mediaDevices.getUserMedia({ [deviceType]: true, [mediaType]: true });
          const mediaElement = document.getElementById(resultElementId);
          mediaElement.srcObject = stream;
          mediaElement.classList.remove('hidden');
        } catch (error) {
          console.error('訪問媒體流時出錯：', error);
        }
      }

      // 按鈕的事件監聽器
      document.getElementById('videoUser').addEventListener('click', () => {
        startMediaStream('facingMode', 'video', 'videoUser');
      });

      document.getElementById('photoUserImage').addEventListener('click', () => {
        startMediaStream('facingMode', 'video', 'photoUserImage');
      });

      document.getElementById('videoEnv').addEventListener('click', () => {
        startMediaStream('facingMode', { exact: 'environment' }, 'videoEnv');
      });

      document.getElementById('photoEnvImage').addEventListener('click', () => {
        startMediaStream('facingMode', { exact: 'environment' }, 'photoEnvImage');
      });

      document.getElementById('audioUser').addEventListener('click', () => {
        startMediaStream('facingMode', 'audio', 'audioUser');
      });
    </script>
  </body>
</html>
